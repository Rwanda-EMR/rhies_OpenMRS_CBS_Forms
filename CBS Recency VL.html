<htmlform>

    <!-- Autogenerated example form  (template from 01-Nov-2010 -->
    <macros>
        @CBS_FINAL_RITA_INCONCLUSIVE@=ba4b8a83-54ab-44f3-a7c5-4495ddf055bc
        @RECENCY_TEST_NAME@=5119a7e8-d4c6-4380-8c12-420cb3deff4d
        @RECENCY_ASSAY_RESULTS@=b4b0e241-e41a-4d46-89dd-e531cf6d8202
        @RECENCY_TEST_DATE@=f97c7656-6369-426a-9597-b3fb9acf25af
        @CBS_FINAL_RITA_RECENCY_RESULT@=a2053e28-9ce9-4647-8a96-6f1b7c62f429
        @RECENCY_VIRAL_LOAD_TEST_DATE@=fa87bb43-ebcc-4919-96f8-c5013ce1bbca
        @RECENCY_VIRAL_LOAD_RESULT@=aae8d7fe-8bbc-4d2e-926c-0e28b4d0e046
        @RECENCY_VIRAL_LOAD_RESULT_DATE@=f4e3f60a-2f62-47bc-b968-156b3df91067
        @RECENT@=fb3b2a61-4f4b-46b2-9187-9ec769349a44
        @LONG-TERM@=819f5ebe-0b3e-44ba-b435-8f3d1b7bb130
        @INVALID@=9340dede-5124-49cf-9b3c-5153cc0e537f
        @NEGATIVE@=3cd28732-26fe-102b-80cb-0017a47871b2
        @RECENCY_SAMPLE_COLLECTION_DATE@=774f49dc-cd95-4f7e-a20f-b38f9a1f52c4
        @YES@=3cd6f600-26fe-102b-80cb-0017a47871b2
        @NO@=3cd6f86c-26fe-102b-80cb-0017a47871b2
        @PATIENT_REFUSED@=efab937b-853e-47da-b97e-220f1bdff97d
        @UNKNOWN@=3cd6fac4-26fe-102b-80cb-0017a47871b2
        paperFormId = (Fill this in)
        headerColor =#009d8e
        fontOnHeaderColor = white
    </macros>

    <style>
        th.tableHeader {
            background-color: #009d8e;
            color: #FFFFFF;
            font-size: 16px;
            text-align: left;
        }

        .section {
            border: 1px solid #009d8e;
            padding: 2px;
            text-align: left;
            margin-bottom: 1em;
        }

        .sectionHeader {
            background-color: #009d8e;
            color: #FFFFFF;
            display: block;
            padding: 2px;
            font-weight: bold;
            text-align: center;
        }

        tr.spaceUnder>td {
            padding-bottom: 1em;
        }

        td {
            font-size: 15px;
        }

        table.baseline-aligned td {
            vertical-align: baseline;
        }

        table,
        td,
        th {
            border: 1px solid black;
            border-collapse: collapse;
        }

        th {
            text-align: left;
            background-color: #D9D9D9;
            font-size: 12px;
        }

        .error {
            display: none;
        }

        .lables {
            width: 200px;
        }

        table {
            width: 100%;
        }

        .selectedCancerStagingKeys {
            page-break-before: always;
            border: 0px;
        }

        table.selectedCancerStagingKeys td {
            border: 0px;
        }

        .mandotory-star {
            color: #ff0000;
        }
    </style>
    <script type="text/javascript">

        if (jQuery) {
            $j(document).ready(function () {

                var url = new URL(window.location.href);

                if (url.searchParams.get("mode") == "EDIT") {//Edit
                    console.log("Mode Edit");
                    $j('.other_reason_here').hide();
                    toggleInput();
                } else if (url.searchParams.get("formId")) {//Creation
                    $j('.other_reason_here').hide();
                    console.log("Mode formId");
                } else {//View the form
                    console.log("Mode view");
                    $j('.other_reason_here').hide();
                    toggleInput();
                }

                $j('#final_rita').change(function () {
                    toggleInput();
                });

                function toggleInput() {
                    if (!getValue('final_rita.value')) {
                        $j('#final_rita_inconclusive').hide();
                        return;
                    }
                    if (getValue('final_rita.value') == "105664") {
                        $j('#final_rita_inconclusive').show();
                    } else {
                        $j('#final_rita_inconclusive').hide();
                    }
                }

                //If  submission does not work redirect with an error message
                beforeSubmit.push(function () {

                    var date = getValue('encounterDate.value');
                    var provider = getValue('encounterProvider.value');
                    var location = getValue('encounterLocation.value');
                    var demographicChange = getValue('testResult.value');

                    if (!date) {
                        getField('encounterDate.error').html('This field is required').show();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return false;
                    } else {
                        getField('encounterDate.error').html('This field is required').hide();
                    }

                    if (!provider) {
                        getField('encounterProvider.error').html('This field is required').show();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return false;
                    } else {
                        getField('encounterProvider.error').html('This field is required').hide();
                    }

                    if (!location) {
                        getField('encounterLocation.error').html('This field is required').show();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return false;
                    } else {
                        getField('encounterLocation.error').html('This field is required').hide();
                    }

                    if (!demographicChange) {
                        getField('testResult.error').html('This field is required').show();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        return false;
                    } else {
                        getField('testResult.error').html('This field is required').hide();
                    }
                    return true;

                });
            });
        }        
    </script>

    <span style="float:right">Paper Form ID: $paperFormId</span>
    <h2>CBS Recency VL (v0.1)</h2>
    <p><strong> CBS Recency VL</strong></p>
    <!--===============================   Section 1 =======================================  -->
    <section headerLabel="1. Encounter Details">
        <table class="baseline-aligned" cellspacing="0" cellpadding="6" width="100%">
            <tr>
                <td>Encounter Date:</td>
                <td>
                    <encounterDate /><span class="mandotory-star">*</span>
                </td>
            </tr>
            <tr>
                <td>Location:</td>
                <td>
                    <encounterLocation default="486" id="encounterLocation" /><span class="mandotory-star">*</span>
                </td>
            </tr>
            <tr>
                <td>Provider:</td>
                <td>
                    <encounterProvider default="admin" /><span class="mandotory-star">*</span>
                </td>
            </tr>
        </table>
    </section>
    <!--===============================   Section 2 =======================================  -->
    <section headerLabel="NEW HIV DIAGNOSIS - RECENCY TESTING (RT) INFORMATION">
        <table class="baseline-aligned" cellspacing="0" cellpadding="6" width="100%">
            <th colspan="2">Recent Infection Testing Algorithm (RITA)</th>
            <tr>
                <td>
                    <strong>Recency Viral Load:</strong><br /><br /><br />
                    <obs conceptId="$@RECENCY_VIRAL_LOAD_TEST_DATE@" labelText="Sample Test date:" /><br /><br />
                    <obs conceptId="$@RECENCY_VIRAL_LOAD_RESULT@" id="testResult" labelText="Test Result:"
                        required='true' /><br /><br />
                    <obs conceptId="$@RECENCY_VIRAL_LOAD_RESULT_DATE@" labelText="Test result return date:" />
                </td>
                <td>
                    <strong>Final RITA result</strong>
                    <obs conceptId="$@CBS_FINAL_RITA_RECENCY_RESULT@"
                        answerConceptIds="$@RECENT@, $@LONG-TERM@, $@INVALID@"
                        answerLabels="RITA RECENT, Long-Term, Inconclusive" style="radio" id="final_rita" />
                    <br /><br />
                    <div class="other_reason_here" id="final_rita_inconclusive">
                        <strong>If Inconclusive, verified:</strong>
                        <obs conceptId="$@CBS_FINAL_RITA_INCONCLUSIVE@" answerConceptIds="$@YES@, $@NO@"
                            answerLabels="Yes(Oui), No(Non)" style="radio" /><br />
                    </div>
                    <br />
                    <strong>Final RITA result Recorded:</strong>
                    <encounterDate />
                </td>

            </tr> <br></br>
        </table>
    </section>

    <submit />


</htmlform>